#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <unistd.h>

void win(){
	system("cat ./flag.txt");
	exit(0);
}

void handler(int num){
	printf("Bye!\n");
	exit(-1);
}

int main(int argc, char **argv){
	signal(SIGALRM, handler);

	volatile int (*fp)();
	char buffer[32];

	fp = 0;
	printf("Win function is at %p\n", win);
	fflush(stdout);

	gets(buffer);

	if(fp){
		printf("Calling function pointer, jumping to 0x%08x\n", fp);
		if (fp == (void *)win){
			fp();
		} else {
			printf("[ERROR] Cannot jump to 0x%08x\n", fp);
			exit(0);
		}
	} else {
		printf("Better luck next time.\n");
		exit(1);
	}
}
