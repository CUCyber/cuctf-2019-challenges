from flask import Flask, request, json
from jinja2 import Environment, PackageLoader, select_autoescape
import subprocess

app = Flask(__name__)

@app.route("/")
def serve_main():
    env = Environment(
            loader=PackageLoader('main', 'templates'),
            autoescape=select_autoescape(['html', 'xml']))
    return env.get_template('index.html').render()
    
@app.route("/api/getQuote/")
def getQuote():
    quotee = request.args.get('quotee')
    return app.response_class(
            response = json.dumps({ "Quote" : subprocess.check_output('python /app/quote_wsgi.py {}'.format(quotee), shell=True).decode('utf-8')}),
            status=200,
            mimetype='application/json'
            )

